Delphi 2005 XML Documentation Viewer Wizard 3.1
author: pawel.glowacki@borland.com [Borland Services]
==========================================================================================

Delphi 2005 XML Documentation Viewer Wizard 3.1 displays current project XML Doc file transformed with XSL transform selectable from the combobox in the embedded Web Browser.
This is the Delphi 2005 version of similar C#Builder plug-in (http://codecentral.borland.com/Item.aspx?id=20544) described in the BDN article (http://bdn.borland.com/article/0,1410,31861,00.html).

BUILDING AND INSTALLING:
1. The "pgXmlDocViewer30" project group contains a standalone version of the viewer for viewing arbitrary XML files, and Delphi 2005 OpenTools plug-in project. Just open the project group and select "Build All" to compile both projects.
2. After successful compilation copy resulting "pgXmlDocViewer30.dll", "AxInterop.SHDocVw.dll", "Interop.SHDocVw.dll", all XSL files and optionally "pgXmlDocViewer30Cfg.xml" to Delphi 2005 "bin" directory (typically "C:\Program Files\Borland\BDS\3.0\Bin").
3. Add new entry to Windows Registry to instruct Delphi 2005 to load the plugin the next it is started. Open Registry Editor (regedit.exe) and under the key "My Computer\HKEY_CURRENT_USER\Software\Borland\BDS\3.0\Known IDE Assemblies" add new string entry "$(BDS)\Bin\pgXmlDocViewer30.dll" with arbitrary value (cannot be blank). WARNING! Edit Windows Registry at your own risk!
4. After restarting Delphi 2005 under the "Help" there should be new "XML Documentation" menu item, that displays the viewer.

VIEWER FUNCTIONALITY:
Selecting "XML Documentation" option from the Delphi 2005 Help menu displays the XML viewer window. There are three tabs on top the Viewer form: "XSL", "XML" and "Doc".
-> "XSL" tab contains a button "Manage XSLs" that displays a dialog window where you can add and remove XSL stylesheets. The list of stylesheets is avaiable from the combobox and persisted in the custom configuration XML file ("pgXmlDocViewer30Cfg.xml"). The configuration file also persists the size and location of the XML Documentation window on the screen. An XSL file selected in the combo box is used for transforming XML Documentation file, and the result is displayed in the embedded WebBrowser control.
-> "XML" tab contains an edit box that displays current XML file being displayed. "Open..." button makes it possible to open for viewing arbitrary XML files. Every time active project in the IDE is changed or compiled, the viewer is refreshed. Make sure that your Project Options has "XML Documentation" compiler option selected, otherwise XML documentation file will not be generated by the compiler.
-> "Doc" tab contains "Refresh" button that refreshes current view, and "Copy to Clipboard" and "Save to file" buttons that help export transformed XML file.

NOTES:
1) After building the project group, you can test the viewer form in the WinForm Application ("pgXmlDocViewer30App.exe") that belongs to the same project group and shares with plugin project all GUI forms. The standalone app has to be terminated through "Program Reset", because the main form prevents destroying itself. If neccessary this can be changed by removing the code from the OnClosing event. However this is desired behaviour for the plug-in: we do not want to recreate the window every time it is displayed.
2) C# and Delphi compilers are generating different XML Doc files with different structure and different names. Names of included XSL files suggests if they are designed for C# (XmlDocCS_*.xsl) or Delphi (XmlDocDelphi_*.xsl) files. These XSL files are for testing only and should be considered "work in progress" functionality.